name: Deploy to production
on:
  push:
    branches:
      - main
permissions:
  id-token: write # This is required for requesting the JWT
  actions: read
  contents: read # This is required for actions/checkout

concurrency:
  group: '${{ github.workflow }} @ ${{ github.event.pull_request.head.label || github.head_ref || github.ref }}'
  cancel-in-progress: true

jobs:
  backend:
    name: Backend deployment
    uses: ./.github/workflows/build-and-push-backend.yml
    secrets: inherit
    with:
      environment: production
